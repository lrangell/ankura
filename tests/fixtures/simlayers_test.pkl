module simlayers_test

import "modulepath:/karabiner_pkl/lib/karabiner.pkl" as karabiner
import "modulepath:/karabiner_pkl/lib/helpers.pkl" as helpers

// Test simultaneous key layers (d-mode, f-mode)
simpleConfig: karabiner.SimpleConfig = new {
  complex_modifications = new karabiner.ComplexModifications {
    parameters = new karabiner.ComplexModificationParameters {
      `basic.simultaneous_threshold_milliseconds` = 200
    }
    
    rules = List(
      // D-mode for yabai window management
      helpers.simlayer("d", new Mapping<String, String | karabiner.ToEvent> {
        ["h"] = helpers.left_arrow
        ["j"] = helpers.down_arrow
        ["k"] = helpers.up_arrow
        ["l"] = helpers.right_arrow
      }, null),
      
      // F-mode for navigation
      helpers.simlayer("f", new Mapping<String, String | karabiner.ToEvent> {
        ["h"] = helpers.left_arrow
        ["j"] = helpers.down_arrow
        ["k"] = helpers.up_arrow
        ["l"] = helpers.right_arrow
      }, null)
    )
  }
}

config: karabiner.Config = simpleConfig.toConfig()